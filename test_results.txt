
[1m============================================================
ResCanvas Backend E2E Tests - Server-Side Security
============================================================[0m

Testing against: http://127.0.0.1:10010

[94m[1mTEST: User Registration[0m
[93mâ„¹ User already exists, logging in instead[0m

[94m[1mTEST: User Login[0m
[92mâœ“ Login: Got expected status 200[0m
[92mâœ“ Login: Field 'token' present[0m
[92mâœ“ Login: Field 'user' present[0m
[92mâœ“ Logged in as testuser[0m
[92mâœ“ Authentication successful. Token: eyJ0eXAiOiJKV1QiLCJh...[0m

[94m[1mTEST: Invalid Authentication[0m
[92mâœ“ No token: Got expected status 401[0m
[92mâœ“ Invalid token: Got expected status 401[0m
[92mâœ“ Invalid signature: Got expected status 401[0m

[94m[1mTEST: Get Current User (/auth/me)[0m
[92mâœ“ Get Me: Got expected status 200[0m
[92mâœ“ Get Me: Field 'user' present[0m
[92mâœ“ Retrieved user: testuser[0m

[94m[1mTEST: Room Creation[0m
[92mâœ“ Create public room: Got expected status 201[0m
[92mâœ“ Room creation: Field 'room' present[0m
[92mâœ“ Created room: 68e6c81286523685692b5ef2[0m
[92mâœ“ Create private room: Got expected status 201[0m
[92mâœ“ Private room created successfully[0m

[94m[1mTEST: List Rooms[0m
[92mâœ“ List rooms: Got expected status 200[0m
[92mâœ“ List rooms: Field 'rooms' present[0m
[92mâœ“ Retrieved 17 rooms[0m
[92mâœ“ Filter by type: Got expected status 200[0m
[92mâœ“ Filtered to 13 public rooms[0m

[94m[1mTEST: Get Room Details[0m
[91mâœ— Get room: Expected 200, got 403[0m
[91mâœ— Response: {
  "code": "AUTHZ_ERROR",
  "message": "Authorization failed",
  "status": "error"
}
[0m

[94m[1mTEST: Post Stroke to Canvas[0m
[92mâœ“ Post stroke: Got expected status 200[0m
[92mâœ“ Stroke posted successfully[0m

[94m[1mTEST: Get Strokes from Canvas[0m
[91mâœ— Get strokes: Expected 200, got 403[0m
[91mâœ— Response: {
  "code": "AUTHZ_ERROR",
  "message": "Authorization failed",
  "status": "error"
}
[0m

[94m[1mTEST: Undo/Redo Operations[0m

[94m[1mTEST: Post Stroke to Canvas[0m
[92mâœ“ Post stroke: Got expected status 200[0m
[92mâœ“ Stroke posted successfully[0m
[92mâœ“ Undo: Got expected status 200[0m
[92mâœ“ Undo successful[0m
[92mâœ“ Redo: Got expected status 200[0m
[92mâœ“ Redo successful[0m
[92mâœ“ Get undo/redo status: Got expected status 200[0m
[92mâœ“ Undo available: True, Redo available: False[0m

[94m[1mTEST: Update Room[0m
[92mâœ“ Update room: Got expected status 200[0m
[92mâœ“ Room updated successfully[0m

[94m[1mTEST: Room Access Control[0m
[92mâœ“ No token access denied: Got expected status 401[0m
[91mâœ— Valid token access granted: Expected 200, got 403[0m
[91mâœ— Response: {
  "code": "AUTHZ_ERROR",
  "message": "Authorization failed",
  "status": "error"
}
[0m
[92mâœ“ Access control working correctly[0m

[94m[1mTEST: Input Validation[0m
[92mâœ“ Empty room name rejected: Got expected status 400[0m
[92mâœ“ Invalid room type rejected: Got expected status 400[0m
[92mâœ“ Input validation working correctly[0m

[94m[1mTEST: Delete Room[0m
[92mâœ“ Delete room: Got expected status 200[0m
[92mâœ“ Room deleted successfully[0m
[92mâœ“ Verify deletion: Got expected status 404[0m
[92mâœ“ Room no longer accessible[0m

[1m[92m============================================================
All tests completed!
============================================================[0m

