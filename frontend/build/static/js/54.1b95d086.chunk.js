"use strict";(self.webpackChunkcanvas_app=self.webpackChunkcanvas_app||[]).push([[54],{48054:(e,t,r)=>{r.r(t),r.d(t,{default:()=>W});var o=r(65043),a=r(7353),s=r(94496),n=r(15795),l=r(11906),i=r(58387),c=r(98610),d=r(34535),p=r(98206),u=r(92532),h=r(72372);function m(e){return(0,h.Ay)("MuiFormGroup",e)}(0,u.A)("MuiFormGroup",["root","row","error"]);var g=r(85213),b=r(74827),f=r(70579);const v=(0,d.Ay)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.row&&t.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),w=o.forwardRef((function(e,t){const r=(0,p.b)({props:e,name:"MuiFormGroup"}),{className:o,row:a=!1,...s}=r,n=(0,g.A)(),l=(0,b.A)({props:r,muiFormControl:n,states:["error"]}),d={...r,row:a,error:l.error},u=(e=>{const{classes:t,row:r,error:o}=e,a={root:["root",r&&"row",o&&"error"]};return(0,c.A)(a,m,t)})(d);return(0,f.jsx)(v,{className:(0,i.A)(u.root,o),ownerState:d,ref:t,...s})}));var y=r(56262),A=r(6803);function k(e){return(0,h.Ay)("MuiFormControlLabel",e)}const x=(0,u.A)("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]);var S=r(4162);const P=(0,d.Ay)("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${x.label}`]:t.label},t.root,t[`labelPlacement${(0,A.A)(r.labelPlacement)}`]]}})((0,y.A)((e=>{let{theme:t}=e;return{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${x.disabled}`]:{cursor:"default"},[`& .${x.label}`]:{[`&.${x.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:e=>{let{labelPlacement:t}=e;return"start"===t||"top"===t||"bottom"===t},style:{marginLeft:16}}]}}))),$=(0,d.Ay)("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((0,y.A)((e=>{let{theme:t}=e;return{[`&.${x.error}`]:{color:(t.vars||t).palette.error.main}}}))),C=o.forwardRef((function(e,t){const r=(0,p.b)({props:e,name:"MuiFormControlLabel"}),{checked:a,className:n,componentsProps:l={},control:d,disabled:u,disableTypography:h,inputRef:m,label:v,labelPlacement:w="end",name:y,onChange:x,required:C,slots:R={},slotProps:j={},value:F,...N}=r,z=(0,g.A)(),B=u??d.props.disabled??z?.disabled,M=C??d.props.required,I={disabled:B,required:M};["checked","name","onChange","value","inputRef"].forEach((e=>{"undefined"===typeof d.props[e]&&"undefined"!==typeof r[e]&&(I[e]=r[e])}));const O=(0,b.A)({props:r,muiFormControl:z,states:["error"]}),L={...r,disabled:B,labelPlacement:w,required:M,error:O.error},T=(e=>{const{classes:t,disabled:r,labelPlacement:o,error:a,required:s}=e,n={root:["root",r&&"disabled",`labelPlacement${(0,A.A)(o)}`,a&&"error",s&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",a&&"error"]};return(0,c.A)(n,k,t)})(L),q={slots:R,slotProps:{...l,...j}},[D,E]=(0,S.A)("typography",{elementType:s.A,externalForwardedProps:q,ownerState:L});let _=v;return null==_||_.type===s.A||h||(_=(0,f.jsx)(D,{component:"span",...E,className:(0,i.A)(T.label,E?.className),children:_})),(0,f.jsxs)(P,{className:(0,i.A)(T.root,n),ownerState:L,ref:t,...N,children:[o.cloneElement(d,I),M?(0,f.jsxs)("div",{children:[_,(0,f.jsxs)($,{ownerState:L,"aria-hidden":!0,className:T.asterisk,children:["\u2009","*"]})]}):_]})}));var R=r(39768),j=r(52445),F=r(61475),N=r(54516),z=r(83424);function B(e){return(0,h.Ay)("PrivateSwitchBase",e)}(0,u.A)("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const M=(0,d.Ay)(z.A)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:e=>{let{edge:t,ownerState:r}=e;return"start"===t&&"small"!==r.size},style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:e=>{let{edge:t,ownerState:r}=e;return"end"===t&&"small"!==r.size},style:{marginRight:-12}}]}),I=(0,d.Ay)("input",{shouldForwardProp:F.A})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),O=o.forwardRef((function(e,t){const{autoFocus:r,checked:o,checkedIcon:a,defaultChecked:s,disabled:n,disableFocusRipple:l=!1,edge:i=!1,icon:d,id:p,inputProps:u,inputRef:h,name:m,onBlur:b,onChange:v,onFocus:w,readOnly:y,required:k=!1,tabIndex:x,type:P,value:$,slots:C={},slotProps:R={},...j}=e,[F,z]=(0,N.A)({controlled:o,default:Boolean(s),name:"SwitchBase",state:"checked"}),O=(0,g.A)();let L=n;O&&"undefined"===typeof L&&(L=O.disabled);const T="checkbox"===P||"radio"===P,q={...e,checked:F,disabled:L,disableFocusRipple:l,edge:i},D=(e=>{const{classes:t,checked:r,disabled:o,edge:a}=e,s={root:["root",r&&"checked",o&&"disabled",a&&`edge${(0,A.A)(a)}`],input:["input"]};return(0,c.A)(s,B,t)})(q),E={slots:C,slotProps:{input:u,...R}},[_,G]=(0,S.A)("root",{ref:t,elementType:M,className:D.root,shouldForwardComponentProp:!0,externalForwardedProps:{...E,component:"span",...j},getSlotProps:e=>({...e,onFocus:t=>{e.onFocus?.(t),(e=>{w&&w(e),O&&O.onFocus&&O.onFocus(e)})(t)},onBlur:t=>{e.onBlur?.(t),(e=>{b&&b(e),O&&O.onBlur&&O.onBlur(e)})(t)}}),ownerState:q,additionalProps:{centerRipple:!0,focusRipple:!l,disabled:L,role:void 0,tabIndex:null}}),[X,J]=(0,S.A)("input",{ref:h,elementType:I,className:D.input,externalForwardedProps:E,getSlotProps:e=>({onChange:t=>{e.onChange?.(t),(e=>{if(e.nativeEvent.defaultPrevented)return;const t=e.target.checked;z(t),v&&v(e,t)})(t)}}),ownerState:q,additionalProps:{autoFocus:r,checked:o,defaultChecked:s,disabled:L,id:T?p:void 0,name:m,readOnly:y,required:k,tabIndex:x,type:P,..."checkbox"===P&&void 0===$?{}:{value:$}}});return(0,f.jsxs)(_,{...G,children:[(0,f.jsx)(X,{...J}),F?a:d]})}));function L(e){return(0,h.Ay)("MuiSwitch",e)}const T=(0,u.A)("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),q=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.edge&&t[`edge${(0,A.A)(r.edge)}`],t[`size${(0,A.A)(r.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${T.thumb}`]:{width:16,height:16},[`& .${T.switchBase}`]:{padding:4,[`&.${T.checked}`]:{transform:"translateX(16px)"}}}}]}),D=(0,d.Ay)(O,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.switchBase,{[`& .${T.input}`]:t.input},"default"!==r.color&&t[`color${(0,A.A)(r.color)}`]]}})((0,y.A)((e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${"light"===t.palette.mode?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${T.checked}`]:{transform:"translateX(20px)"},[`&.${T.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${"light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${T.checked} + .${T.track}`]:{opacity:.5},[`&.${T.disabled} + .${T.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:""+("light"===t.palette.mode?.12:.2)},[`& .${T.input}`]:{left:"-100%",width:"300%"}}})),(0,y.A)((e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,R.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter((0,j.A)(["light"])).map((e=>{let[r]=e;return{props:{color:r},style:{[`&.${T.checked}`]:{color:(t.vars||t).palette[r].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[r].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:(0,R.X4)(t.palette[r].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${T.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${r}DisabledColor`]:`${"light"===t.palette.mode?(0,R.a)(t.palette[r].main,.62):(0,R.e$)(t.palette[r].main,.55)}`}},[`&.${T.checked} + .${T.track}`]:{backgroundColor:(t.vars||t).palette[r].main}}}}))]}}))),E=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})((0,y.A)((e=>{let{theme:t}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${"light"===t.palette.mode?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:""+("light"===t.palette.mode?.38:.3)}}))),_=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})((0,y.A)((e=>{let{theme:t}=e;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}}))),G=o.forwardRef((function(e,t){const r=(0,p.b)({props:e,name:"MuiSwitch"}),{className:o,color:a="primary",edge:s=!1,size:n="medium",sx:l,...d}=r,u={...r,color:a,edge:s,size:n},h=(e=>{const{classes:t,edge:r,size:o,color:a,checked:s,disabled:n}=e,l={root:["root",r&&`edge${(0,A.A)(r)}`,`size${(0,A.A)(o)}`],switchBase:["switchBase",`color${(0,A.A)(a)}`,s&&"checked",n&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},i=(0,c.A)(l,L,t);return{...t,...i}})(u),m=(0,f.jsx)(_,{className:h.thumb,ownerState:u});return(0,f.jsxs)(q,{className:(0,i.A)(h.root,o),sx:l,ownerState:u,children:[(0,f.jsx)(D,{type:"checkbox",icon:m,checkedIcon:m,ref:t,ownerState:u,...d,classes:{...h,root:h.switchBase}}),(0,f.jsx)(E,{className:h.track,ownerState:u})]})}));var X=r(64165),J=r(53517),H=r(75267);function W(){const[e,t]=o.useState(""),[r,i]=o.useState(!1),[c,d]=o.useState({open:!1,message:""}),[p,u]=(0,o.useState)({}),[h,m]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{const e=localStorage.getItem("auth");if(!e)return;const t=JSON.parse(e);(async()=>{try{const e=await(0,H.getNotificationPreferences)(t.token),r={};["invite","share_added","ownership_transfer","removed","invite_response","member_left"].forEach((t=>r[t]=!e||"boolean"!==typeof e[t]||e[t])),u(r)}catch(e){console.error("failed to load prefs",e)}})()}),[]),(0,f.jsxs)(a.A,{sx:{p:2},children:[(0,f.jsx)(s.A,{variant:"h6",children:"Profile & Preferences"}),(0,f.jsx)(n.A,{label:"New password",value:e,onChange:e=>t(e.target.value),sx:{my:2},type:"password"}),(0,f.jsx)(a.A,{children:(0,f.jsx)(l.A,{variant:"contained",onClick:async function(){if(!e||e.length<6)return void d({open:!0,message:"Password must be at least 6 characters"});const r=localStorage.getItem("auth");if(!r)return void d({open:!0,message:"Not authenticated"});const o=JSON.parse(r);i(!0);try{await(0,J.ec)(o.token,e),d({open:!0,message:"Password changed"}),t("")}catch(a){console.error(a),d({open:!0,message:a.message||"Failed to change password"})}finally{i(!1)}},disabled:r,children:r?"Saving...":"Change Password"})}),(0,f.jsxs)(a.A,{sx:{mt:3},children:[(0,f.jsx)(s.A,{variant:"subtitle1",children:"Notification Preferences"}),(0,f.jsxs)(w,{children:[0===Object.keys(p).length&&(0,f.jsx)(s.A,{variant:"body2",children:"Loading preferences..."}),Object.keys(p).map((e=>(0,f.jsx)(C,{control:(0,f.jsx)(G,{checked:p[e],onChange:t=>async function(e,r){const o=localStorage.getItem("auth");if(!o)return d({open:!0,message:"Not authenticated"});const a=JSON.parse(o),s={...p,[e]:r};u(s),m(!0);try{await(0,H.updateNotificationPreferences)(a.token,s),d({open:!0,message:"Preferences saved"})}catch(t){console.error("save prefs failed",t),d({open:!0,message:"Failed to save preferences"})}finally{m(!1)}}(e,t.target.checked),disabled:h}),label:e.replace(/_/g," ")},e)))]})]}),(0,f.jsx)(X.A,{open:c.open,message:c.message,autoHideDuration:4e3,onClose:()=>d({open:!1,message:""})})]})}}}]);
//# sourceMappingURL=54.1b95d086.chunk.js.map