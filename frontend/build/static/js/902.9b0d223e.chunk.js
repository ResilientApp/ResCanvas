"use strict";(self.webpackChunkcanvas_app=self.webpackChunkcanvas_app||[]).push([[902],{86902:(t,e,s)=>{s.r(e),s.d(e,{default:()=>g});var a=s(65043),n=s(7353),r=s(11906),i=s(81637),o=s(68903),c=s(12110),l=s(26494),d=s(94496),h=s(70579);function x(t){let{title:e,text:s}=t;return(0,h.jsx)(c.A,{sx:{mb:2},children:(0,h.jsxs)(l.A,{children:[(0,h.jsx)(d.A,{variant:"h6",children:e}),(0,h.jsx)(d.A,{variant:"body2",sx:{mt:1,whiteSpace:"pre-line"},children:s})]})})}var u=s(61354);function y(t){let{pairs:e=[],width:s=600,height:n=300}=t;const r=(0,a.useRef)();return(0,a.useEffect)((()=>{const t=new Map,a=[];e.forEach((e=>{const s=e[0],n=e[1],r=e[2]||1;t.has(s)||t.set(s,{id:s}),t.has(n)||t.set(n,{id:n}),a.push({source:s,target:n,weight:r})}));const i=Array.from(t.values()),o=u.Ltv(r.current);o.selectAll("*").remove(),o.attr("viewBox",`0 0 ${s} ${n}`).style("width","100%").style("height","auto");const c=o.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll("line").data(a).join("line").attr("stroke-width",(t=>Math.sqrt(t.weight)));const l=u.tXi(i).force("link",u.kJC(a).id((t=>t.id)).distance(50).strength((t=>Math.min(.9,t.weight/10)))).force("charge",u.xJS().strength(-120)).force("center",u.jTM(s/2,n/2)).on("tick",(function(){c.attr("x1",(t=>t.source.x)).attr("y1",(t=>t.source.y)).attr("x2",(t=>t.target.x)).attr("y2",(t=>t.target.y)),d.attr("cx",(t=>t.x)).attr("cy",(t=>t.y)),x.attr("x",(t=>t.x)).attr("y",(t=>t.y))}));const d=o.append("g").attr("stroke","#fff").attr("stroke-width",1.5).selectAll("circle").data(i).join("circle").attr("r",8).attr("fill","#25D8C5").call((h=l,u.$Er().on("start",(function(t,e){t.active||h.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y})).on("drag",(function(t,e){e.fx=t.x,e.fy=t.y})).on("end",(function(t,e){t.active||h.alphaTarget(0),e.fx=null,e.fy=null}))));var h;const x=o.append("g").selectAll("text").data(i).join("text").attr("font-size",10).attr("dx",12).attr("dy",".35em").text((t=>t.id));return()=>{null===l||void 0===l||l.stop()}}),[e,s,n]),(0,h.jsxs)("div",{style:{padding:12},children:[(0,h.jsx)("h4",{children:"Collaboration Graph"}),(0,h.jsx)("svg",{ref:r})]})}function p(t){let{points:e=[],width:s=600,height:n=400}=t;const r=(0,a.useRef)(null);return(0,a.useEffect)((()=>{const t=r.current;if(!t)return;const a=window.devicePixelRatio||1;t.width=s*a,t.height=n*a,t.style.width="100%",t.style.height="auto";const i=t.getContext("2d");if(i.scale(a,a),i.clearRect(0,0,s,n),!e||0===e.length)return;const o=e.every((t=>t.x<=1&&t.y<=1)),c=e.map((t=>({x:o?t.x*s:t.x,y:o?t.y*n:t.y,intensity:Math.min(1,t.intensity||.5)}))),l=Math.max(...c.map((t=>t.intensity)),.001);c.forEach((t=>{const e=t.intensity/l,s=30*e+8,a=i.createRadialGradient(t.x,t.y,0,t.x,t.y,s);a.addColorStop(0,`rgba(255,255,0,${.6*e})`),a.addColorStop(.6,`rgba(255,128,0,${.45*e})`),a.addColorStop(1,"rgba(255,0,0,0)"),i.fillStyle=a,i.beginPath(),i.arc(t.x,t.y,s,0,2*Math.PI),i.fill()}))}),[e,s,n]),(0,h.jsx)("canvas",{ref:r,width:s,height:n,style:{width:"100%",height:"auto",borderRadius:8,background:"#fff"}})}var f=s(93533);function g(){const[t,e]=(0,a.useState)(!0),[s,c]=(0,a.useState)(null),[l,d]=(0,a.useState)(null);(0,a.useEffect)((()=>{!async function(){try{const t=await fetch(`${f.t}/api/analytics/overview`);if(!t.ok)return console.error("Failed to fetch analytics overview:",t.status,t.statusText),void e(!1);const s=t.headers.get("content-type");if(!s||!s.includes("application/json"))return console.error("Response is not JSON:",s),void e(!1);const a=await t.json();c(a)}catch(t){console.error(t)}e(!1)}()}),[]);return(0,h.jsxs)(n.A,{sx:{p:2},children:[(0,h.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,h.jsx)("h2",{children:"Analytics Dashboard"}),(0,h.jsx)(r.A,{onClick:async()=>{e(!0);try{const t=await fetch(`${f.t}/api/analytics/insights`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!t.ok)return console.error("Failed to generate insights:",t.status,t.statusText),void e(!1);const s=t.headers.get("content-type");if(!s||!s.includes("application/json"))return console.error("Response is not JSON:",s),void e(!1);const a=await t.json();d(a)}catch(t){console.error(t)}e(!1)},variant:"contained",children:"Generate Insights"})]}),t&&(0,h.jsx)(i.A,{}),!t&&(0,h.jsxs)(o.Ay,{container:!0,spacing:2,children:[(0,h.jsxs)(o.Ay,{item:!0,xs:12,md:6,children:[s&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x,{title:"Overview Statistics",text:`Total Strokes: ${s.total_strokes||0}\nActive Users: ${s.active_users||0}\nTotal Rooms: ${s.total_rooms||0}`}),s.top_colors&&s.top_colors.length>0&&(0,h.jsx)(x,{title:"Top Colors",text:s.top_colors.join(", ")})]}),!s&&(0,h.jsx)(x,{title:"Overview",text:"No analytics data available. Start drawing in rooms to generate analytics!"}),l&&l.summary&&(0,h.jsx)(x,{title:"AI Insights Summary",text:l.summary||""}),l&&l.recommendations&&l.recommendations.map(((t,e)=>(0,h.jsx)(x,{title:`Recommendation ${e+1}`,text:t},e)))]}),(0,h.jsxs)(o.Ay,{item:!0,xs:12,md:6,children:[(0,h.jsx)(p,{points:s&&s.heatmap_points||[]}),(0,h.jsx)(y,{pairs:s&&s.collaboration_pairs||[]})]})]})]})}}}]);
//# sourceMappingURL=902.9b0d223e.chunk.js.map