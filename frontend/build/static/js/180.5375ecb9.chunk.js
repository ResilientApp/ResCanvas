"use strict";(self.webpackChunkcanvas_app=self.webpackChunkcanvas_app||[]).push([[180],{77180:(s,e,n)=>{n.r(e),n.d(e,{default:()=>_});var i=n(65043),t=n(93533),r=n(7353),l=n(94496),o=n(11906),a=n(81637),c=n(61596),d=n(68903),h=n(58387),u=n(98610),x=n(34535),v=n(98206),m=n(92532),j=n(72372);function A(s){return(0,j.Ay)("MuiTableContainer",s)}(0,m.A)("MuiTableContainer",["root"]);var p=n(70579);const f=(0,x.Ay)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(s,e)=>e.root})({width:"100%",overflowX:"auto"}),g=i.forwardRef((function(s,e){const n=(0,v.b)({props:s,name:"MuiTableContainer"}),{className:i,component:t="div",...r}=n,l={...n,component:t},o=(s=>{const{classes:e}=s;return(0,u.A)({root:["root"]},A,e)})(l);return(0,p.jsx)(f,{ref:e,as:t,className:(0,h.A)(o.root,i),ownerState:l,...r})}));var w=n(71806),y=n(73460),b=n(28076),k=n(10039),T=(n(83034),n(88133));function _(){var s,e,n,h,u,x,v,m,j,A,f,_,C,R,S,M,F,E;const[N,L]=(0,i.useState)(!1),[$,z]=(0,i.useState)(null);async function B(){L(!0);try{const e=await fetch(`${t.t}/metrics`),n=e.headers.get("content-type")||"";let i=null;if(n.includes("application/json"))i=await e.json();else{const n=await e.text();try{i=JSON.parse(n)}catch(s){i={errorText:n||`[non-json response, status ${e.status}]`}}}e.ok&&i&&i.metrics?z(i.metrics):(console.warn("fetchLatest: non-ok response",e.status,i),z(null))}catch(e){console.error(e),z(null)}finally{L(!1)}}return(0,i.useEffect)((()=>{B()}),[]),(0,p.jsxs)(r.A,{sx:{p:3},children:[(0,p.jsx)(l.A,{variant:"h5",gutterBottom:!0,children:"ResCanvas Metrics Dashboard"}),(0,p.jsxs)(r.A,{sx:{mb:2},children:[(0,p.jsx)(o.A,{variant:"contained",onClick:async function(){L(!0);try{const i=await fetch(`${t.t}/runBenchmarks`,{method:"POST"}),r=i.headers.get("content-type")||"";let l=null;if(r.includes("application/json"))l=await i.json();else{const s=await i.text();try{l=JSON.parse(s)}catch(n){l={errorText:s||`[non-json response, status ${i.status}]`}}}if(i.ok&&l&&l.metrics)z(l.metrics);else{var s,e;console.error("runBenchmarks failed",i.status,l);const n=(null===(s=l)||void 0===s?void 0:s.message)||(null===(e=l)||void 0===e?void 0:e.errorText)||`HTTP ${i.status}`;(0,T.A)("Run benchmarks failed: "+n)}}catch(i){console.error(i),(0,T.A)("Run benchmarks error: "+(i.message||i))}finally{L(!1)}},disabled:N,children:"Run Benchmarks"})," ",(0,p.jsx)(o.A,{variant:"outlined",onClick:B,disabled:N,children:"Refresh Latest"}),N&&(0,p.jsx)(a.A,{size:20,sx:{ml:2}})]}),!$&&(0,p.jsx)(c.A,{sx:{p:2},children:(0,p.jsx)(l.A,{children:"No metrics available. Run benchmarks to produce metrics."})}),$&&(0,p.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,p.jsx)(d.Ay,{item:!0,xs:12,md:4,children:(0,p.jsxs)(c.A,{sx:{p:2},children:[(0,p.jsx)(l.A,{variant:"subtitle1",children:"Summary"}),(0,p.jsxs)(l.A,{children:["Timestamp: ",new Date($.timestamp_ms).toLocaleString()]})]})}),(0,p.jsx)(d.Ay,{item:!0,xs:12,md:8,children:(0,p.jsxs)(c.A,{sx:{p:2},children:[(0,p.jsx)(l.A,{variant:"subtitle1",children:"Redis Metrics"}),(0,p.jsx)(g,{children:(0,p.jsx)(w.A,{size:"small",children:(0,p.jsxs)(y.A,{children:[(0,p.jsxs)(b.A,{children:[(0,p.jsx)(k.A,{children:"Ping (ms)"}),(0,p.jsx)(k.A,{children:null!==(s=null===(e=$.redis)||void 0===e||null===(n=e.ping_ms)||void 0===n?void 0:n.toFixed(2))&&void 0!==s?s:"\u2014"})]}),(0,p.jsxs)(b.A,{children:[(0,p.jsx)(k.A,{children:"SET avg (ms)"}),(0,p.jsx)(k.A,{children:null!==(h=null===(u=$.redis)||void 0===u||null===(x=u.set_ms_avg)||void 0===x?void 0:x.toFixed(2))&&void 0!==h?h:"\u2014"})]}),(0,p.jsxs)(b.A,{children:[(0,p.jsx)(k.A,{children:"GET avg (ms)"}),(0,p.jsx)(k.A,{children:null!==(v=null===(m=$.redis)||void 0===m||null===(j=m.get_ms_avg)||void 0===j?void 0:j.toFixed(2))&&void 0!==v?v:"\u2014"})]})]})})})]})}),(0,p.jsx)(d.Ay,{item:!0,xs:12,children:(0,p.jsxs)(c.A,{sx:{p:2},children:[(0,p.jsx)(l.A,{variant:"subtitle1",children:"Mongo Metrics"}),(0,p.jsx)(g,{children:(0,p.jsx)(w.A,{size:"small",children:(0,p.jsxs)(y.A,{children:[(0,p.jsxs)(b.A,{children:[(0,p.jsx)(k.A,{children:"Insert avg (ms)"}),(0,p.jsx)(k.A,{children:null!==(A=null===(f=$.mongo)||void 0===f||null===(_=f.insert_ms_avg)||void 0===_?void 0:_.toFixed(2))&&void 0!==A?A:"\u2014"})]}),(0,p.jsxs)(b.A,{children:[(0,p.jsx)(k.A,{children:"Find avg (ms)"}),(0,p.jsx)(k.A,{children:null!==(C=null===(R=$.mongo)||void 0===R||null===(S=R.find_ms_avg)||void 0===S?void 0:S.toFixed(2))&&void 0!==C?C:"\u2014"})]})]})})})]})}),(0,p.jsx)(d.Ay,{item:!0,xs:12,children:(0,p.jsxs)(c.A,{sx:{p:2},children:[(0,p.jsx)(l.A,{variant:"subtitle1",children:"GraphQL Metrics"}),(0,p.jsx)(w.A,{size:"small",children:(0,p.jsx)(y.A,{children:(0,p.jsxs)(b.A,{children:[(0,p.jsx)(k.A,{children:"GraphQL avg (ms)"}),(0,p.jsx)(k.A,{children:null!==(M=null===(F=$.graphql)||void 0===F||null===(E=F.graphql_ms_avg)||void 0===E?void 0:E.toFixed(2))&&void 0!==M?M:"\u2014"})]})})})]})})]})]})}},88133:(s,e,n)=>{function i(s){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3;try{const n={message:String(s),duration:e},i=new CustomEvent("rescanvas:notify",{detail:n});if(window&&"function"===typeof window.dispatchEvent)return void window.dispatchEvent(i)}catch(n){}console.warn("NOTIFY:",s)}n.d(e,{A:()=>i})}}]);
//# sourceMappingURL=180.5375ecb9.chunk.js.map